<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ page import="java.sql.*" %>
<%@ page import="com.database.dbconn" %>

<%
    // Get form data
    String fullName = request.getParameter("full-name");
    String email = request.getParameter("email");
    String contact = request.getParameter("contact");
    String username = request.getParameter("username");
    String password = request.getParameter("password");

    // Perform database operations
    Connection conn = null;
    PreparedStatement statement = null;
    
    try {
        // Establish the database connection
        conn = dbconn.getConnection();
        
        if (conn != null) {
            System.out.println("Database connected");

            // Insert user details into the database
            String insertQuery = "INSERT INTO user (full_name, email, contact, username, password) VALUES (?, ?, ?, ?, ?)";
            statement = conn.prepareStatement(insertQuery);
            statement.setString(1, fullName);
            statement.setString(2, email);
            statement.setString(3, contact);
            statement.setString(4, username);
            statement.setString(5, password);
            statement.executeUpdate();

            // Redirect to a success page
            response.sendRedirect("success.html");
        } else {
            // Handle the case when the connection is null
            System.out.println("Error connecting to the database");
            response.sendRedirect("error.html");
        }
    } catch (SQLException e) {
        e.printStackTrace();
        // Handle the database error
        response.sendRedirect("error.html");
    } finally {
        // Close the database connection and statement
        try {
            if (statement != null) {
                statement.close();
            }
            if (conn != null) {
                conn.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
%>
